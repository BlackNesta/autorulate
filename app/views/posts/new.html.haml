= provide(:title, "New Post")

= form_with(model: @post, method: :post, local: true) do |f|
  = render 'shared/error_messages', object: @post

  = f.label :title
  = f.text_field :title, class: "form-control", autocomplete: "off", required: true

  = f.label :descritpion
  .field 
    = f.text_area :content, placeholder: "Add description...", class: "form-control", autocomplete: "off"

  .images
    - (1..10).each do |i|
      .image
        = image_tag("add-photo.pgn", size: "200x200", id: "image-#{i}", onclick: "addPhoto(#{i})", style: "cursor:pointer")
        = f.file_field "images[#{i}]", multiple: false, accept: "image/jpeg,image/gif,image/png", class: "post_images", style: "display:none", id: "post-images-#{i}", onchange:"readURL(this, #{i})"
  = f.submit "Add Post", class: "btn btn-primary"

:javascript
  $(".post_images").bind("change", function() {
    const size_in_megabytes = this.files[0].size/1024/1024;
    if (size_in_megabytes > 5) {
      alert("Maximum file size is 5MB. Please choose a smaller file.");
      $("#post_image").val("");
    }
  });

  function addPhoto(i) {
    $("#post-images-" + i).trigger('click')
  }

  function readURL(input, i) {
    if (input.files && input.files[0]) {
      var reader = new FileReader();
      reader.onload = function (e) {
        $('#image-' + i)
          .attr('src', e.target.result)
          .maxidth(200)
          .height(200);
      };

      reader.readAsDataURL(input.files[0]);
    }
  }